{
  "spec_version": 1,
  "app": {
    "title": "UESRPG Session Manager",
    "window": {
      "size": [1100, 720],
      "min_size": [980, 640],
      "resizable": true
    }
  },
  "theme": {
    "colors": {
      "bg": "#FFD5AF",
      "fg": "#9D6E6B",
      "panel_bg": "#FFD5AF",
      "border": "#9D6E6B",
      "accent": "#9D6E6B"
    },
    "typography": {
      "base": { "family": "TkDefaultFont", "size": 10, "weight": "normal", "slant": "roman" },
      "heading": { "family": "TkDefaultFont", "size": 11, "weight": "bold", "slant": "roman" },
      "skill": { "family": "TkDefaultFont", "size": 10, "weight": "normal", "slant": "italic" }
    },
    "spacing": {
      "padx": 8,
      "pady": 6,
      "section_gap_y": 10,
      "field_gap_x": 8,
      "field_gap_y": 4
    }
  },
  "data": {
    "character_root": "$",
    "portrait_dir": "uesrpg_sm/assets/portraits",
    "default_character": {
      "system": "UESRPG 3e",
      "name": "",
      "size": "",
      "xp": { "current": 0, "total": 0 },
      "race": "",
      "elite_adv": "",
      "favored_characteristics": [],
      "birthsign": { "category": "", "sign": "", "star_cursed": false, "effects": [] },
      "luck_numbers": { "lucky": [], "unlucky": [] },
      "characteristics": [
        { "abbr": "Str", "name": "Strength", "score": 0, "bonus": 0, "favored": false },
        { "abbr": "End", "name": "Endurance", "score": 0, "bonus": 0, "favored": false },
        { "abbr": "Ag", "name": "Agility", "score": 0, "bonus": 0, "favored": false },
        { "abbr": "Int", "name": "Intelligence", "score": 0, "bonus": 0, "favored": false },
        { "abbr": "Wp", "name": "Willpower", "score": 0, "bonus": 0, "favored": false },
        { "abbr": "Prc", "name": "Perception", "score": 0, "bonus": 0, "favored": false },
        { "abbr": "Prs", "name": "Personality", "score": 0, "bonus": 0, "favored": false },
        { "abbr": "Lck", "name": "Luck", "score": 0, "bonus": 0, "favored": false }
      ],
      "base_bonuses": { "SB": 0, "EB": 0, "AB": 0, "IB": 0, "WB": 0, "PcB": 0, "PsB": 0, "LB": 0 },
      "derived_stats": {
        "HP": { "current": 0, "max": 0 },
        "MP": { "current": 0, "max": 0 },
        "WT": { "current": 0, "max": 0 },
        "SP": { "current": 0, "max": 0 },
        "Speed_m": 0,
        "LP": { "current": 0, "max": 0 },
        "IR": 0,
        "AP": { "current": 0, "max": 0 },
        "Linguistics": 0,
        "ENC": { "current": 0, "max": 0 },
        "CR": 0
      },
      "languages": [],
      "bonds": [],
      "armor": {
        "slots": {
          "head_0": { "label": "Head (0)", "AR": 0, "ENC": 0, "Type": "" },
          "body_1_5": { "label": "Body (1-5)", "AR": 0, "ENC": 0, "Type": "" },
          "right_leg_6": { "label": "Right Leg (6)", "AR": 0, "ENC": 0, "Type": "" },
          "left_leg_7": { "label": "Left Leg (7)", "AR": 0, "ENC": 0, "Type": "" },
          "right_arm_8": { "label": "Right Arm (8)", "AR": 0, "ENC": 0, "Type": "" },
          "left_arm_9": { "label": "Left Arm (9)", "AR": 0, "ENC": 0, "Type": "" }
        },
        "shield": { "BR": 0, "Type": "", "ENC": 0 },
        "notes": ""
      },
      "wounds": "",
      "conditions": "",
      "skills": [],
      "professions_custom_skills": "",
      "combat_style": { "name": "", "governing": ["Strength", "Agility"] },
      "specializations": "",
      "melee_weapons": [],
      "ranged_weapons": [],
      "talents_traits_powers": "",
      "items_equipment": [],
      "total_enc": 0,
      "drakes": 0,
      "rituals": "",
      "magic_skills": [],
      "spellcasting": "",
      "spells": [],
      "portrait": { "file": "" }
    }
  },
  "menus": [
    {
      "label": "File",
      "items": [
        { "label": "New", "command": "file_new" },
        { "label": "Open…", "command": "file_open" },
        { "label": "Save", "command": "file_save" },
        { "label": "Save As…", "command": "file_save_as" },
        { "type": "separator" },
        { "label": "Exit", "command": "app_exit" }
      ]
    },
    {
      "label": "Import",
      "items": [
        { "label": "Import Base Data…", "command": "import_base_data" }
      ]
    }
  ],
  "windows": [
    {
      "id": "character_window",
      "type": "main",
      "title": "Character",
      "layout": {
        "type": "grid",
        "columns": [
          { "id": "left", "weight": 0, "min": 220 },
          { "id": "main", "weight": 1, "min": 760 }
        ]
      },
      "left_panel": {
        "id": "portrait_panel",
        "title": "Portrait",
        "widgets": [
          {
            "type": "image",
            "id": "portrait_image",
            "bind": "$.portrait.file",
            "max_size": [200, 240],
            "placeholder": "No portrait selected"
          },
          {
            "type": "button",
            "id": "select_portrait",
            "text": "Select Portrait…",
            "command": "select_portrait_from_dir"
          },
          {
            "type": "label",
            "id": "portrait_hint",
            "text": "Put images into assets/portraits (png/jpg/gif).",
            "style": "base"
          }
        ]
      },
      "main_panel": {
        "type": "notebook",
        "tabs": [
          {
            "id": "tab_core",
            "title": "Core",
            "sections": [
              {
                "id": "header_block",
                "title": "Header",
                "layout": { "type": "grid", "columns": 6 },
                "widgets": [
                  { "type": "field", "label": "Name", "bind": "$.name", "widget": "entry", "colspan": 2 },
                  { "type": "field", "label": "Size", "bind": "$.size", "widget": "entry", "colspan": 1 },

                  { "type": "field", "label": "XP (current)", "bind": "$.xp.current", "widget": "spin_int", "min": 0, "max": 999999, "colspan": 1 },
                  { "type": "field", "label": "XP (total)", "bind": "$.xp.total", "widget": "spin_int", "min": 0, "max": 999999, "colspan": 1 },
                  { "type": "field", "label": "Race", "bind": "$.race", "widget": "entry", "colspan": 1 },

                  { "type": "field", "label": "Elite Adv.", "bind": "$.elite_adv", "widget": "entry", "colspan": 2 },
                  { "type": "field", "label": "Birthsign (category)", "bind": "$.birthsign.category", "widget": "entry", "colspan": 2 },
                  { "type": "field", "label": "Birthsign (sign)", "bind": "$.birthsign.sign", "widget": "entry", "colspan": 1 },
                  { "type": "field", "label": "Star-Cursed", "bind": "$.birthsign.star_cursed", "widget": "check", "colspan": 1 },

                  {
                    "type": "field",
                    "label": "Favored",
                    "bind": "$.favored_characteristics",
                    "widget": "tags",
                    "hint": "e.g. Strength, Agility",
                    "colspan": 2
                  },
                  {
                    "type": "field",
                    "label": "Lucky #s",
                    "bind": "$.luck_numbers.lucky",
                    "widget": "int_list_csv",
                    "hint": "comma-separated",
                    "colspan": 2
                  },
                  {
                    "type": "field",
                    "label": "Unlucky #s",
                    "bind": "$.luck_numbers.unlucky",
                    "widget": "int_list_csv",
                    "hint": "comma-separated",
                    "colspan": 2
                  }
                ]
              },
              {
                "id": "characteristics_block",
                "title": "Characteristics",
                "layout": { "type": "grid", "columns": 8 },
                "widgets": [
                  {
                    "type": "table_inline",
                    "id": "characteristics_inline",
                    "bind": "$.characteristics",
                    "columns": [
                      { "key": "abbr", "label": "Abbr", "width": 6, "readonly": true },
                      { "key": "score", "label": "Score", "width": 6 },
                      { "key": "bonus", "label": "Bonus", "width": 6 },
                      { "key": "favored", "label": "Fav", "width": 4, "widget": "check" }
                    ],
                    "row_order": ["Str", "End", "Ag", "Int", "Wp", "Prc", "Prs", "Lck"],
                    "style": "base"
                  },
                  {
                    "type": "group",
                    "id": "base_bonuses",
                    "title": "SB EB AB IB WB PcB PsB LB",
                    "layout": { "type": "grid", "columns": 8 },
                    "widgets": [
                      { "type": "field", "label": "SB", "bind": "$.base_bonuses.SB", "widget": "spin_int", "min": 0, "max": 99 },
                      { "type": "field", "label": "EB", "bind": "$.base_bonuses.EB", "widget": "spin_int", "min": 0, "max": 99 },
                      { "type": "field", "label": "AB", "bind": "$.base_bonuses.AB", "widget": "spin_int", "min": 0, "max": 99 },
                      { "type": "field", "label": "IB", "bind": "$.base_bonuses.IB", "widget": "spin_int", "min": 0, "max": 99 },
                      { "type": "field", "label": "WB", "bind": "$.base_bonuses.WB", "widget": "spin_int", "min": 0, "max": 99 },
                      { "type": "field", "label": "PcB", "bind": "$.base_bonuses.PcB", "widget": "spin_int", "min": 0, "max": 99 },
                      { "type": "field", "label": "PsB", "bind": "$.base_bonuses.PsB", "widget": "spin_int", "min": 0, "max": 99 },
                      { "type": "field", "label": "LB", "bind": "$.base_bonuses.LB", "widget": "spin_int", "min": 0, "max": 99 }
                    ]
                  }
                ]
              },
              {
                "id": "derived_stats_block",
                "title": "Attributes",
                "layout": { "type": "grid", "columns": 4 },
                "widgets": [
                  { "type": "field", "label": "HP (cur)", "bind": "$.derived_stats.HP.current", "widget": "spin_int", "min": 0, "max": 999 },
                  { "type": "field", "label": "HP (max)", "bind": "$.derived_stats.HP.max", "widget": "spin_int", "min": 0, "max": 999 },
                  { "type": "field", "label": "MP (cur)", "bind": "$.derived_stats.MP.current", "widget": "spin_int", "min": 0, "max": 999 },
                  { "type": "field", "label": "MP (max)", "bind": "$.derived_stats.MP.max", "widget": "spin_int", "min": 0, "max": 999 },

                  { "type": "field", "label": "WT (cur)", "bind": "$.derived_stats.WT.current", "widget": "spin_int", "min": 0, "max": 999 },
                  { "type": "field", "label": "WT (max)", "bind": "$.derived_stats.WT.max", "widget": "spin_int", "min": 0, "max": 999 },
                  { "type": "field", "label": "SP (cur)", "bind": "$.derived_stats.SP.current", "widget": "spin_int", "min": 0, "max": 999 },
                  { "type": "field", "label": "SP (max)", "bind": "$.derived_stats.SP.max", "widget": "spin_int", "min": 0, "max": 999 },

                  { "type": "field", "label": "Speed (m)", "bind": "$.derived_stats.Speed_m", "widget": "spin_int", "min": 0, "max": 999 },
                  { "type": "field", "label": "LP (cur)", "bind": "$.derived_stats.LP.current", "widget": "spin_int", "min": 0, "max": 999 },
                  { "type": "field", "label": "LP (max)", "bind": "$.derived_stats.LP.max", "widget": "spin_int", "min": 0, "max": 999 },
                  { "type": "field", "label": "IR", "bind": "$.derived_stats.IR", "widget": "spin_int", "min": 0, "max": 999 },

                  { "type": "field", "label": "AP (cur)", "bind": "$.derived_stats.AP.current", "widget": "spin_int", "min": 0, "max": 999 },
                  { "type": "field", "label": "AP (max)", "bind": "$.derived_stats.AP.max", "widget": "spin_int", "min": 0, "max": 999 },
                  { "type": "field", "label": "Linguistics", "bind": "$.derived_stats.Linguistics", "widget": "spin_int", "min": 0, "max": 99 },
                  { "type": "field", "label": "ENC / CR", "bind": "$.derived_stats.ENC.current", "widget": "spin_int", "min": 0, "max": 999, "suffix_bind": "$.derived_stats.CR" },

                  { "type": "field", "label": "ENC (max)", "bind": "$.derived_stats.ENC.max", "widget": "spin_int", "min": 0, "max": 999, "colspan": 1 }
                ]
              },
              {
                "id": "languages_bonds_block",
                "title": "Languages & Bonds",
                "layout": { "type": "grid", "columns": 2 },
                "widgets": [
                  { "type": "field", "label": "Languages", "bind": "$.languages", "widget": "tags", "hint": "comma-separated", "colspan": 1 },
                  { "type": "field", "label": "Bonds", "bind": "$.bonds", "widget": "tags", "hint": "comma-separated", "colspan": 1 }
                ]
              },
              {
                "id": "wounds_conditions_size",
                "title": "Wounds / Conditions / Size",
                "layout": { "type": "grid", "columns": 3 },
                "widgets": [
                  { "type": "field", "label": "Wounds", "bind": "$.wounds", "widget": "textarea", "height": 5, "colspan": 1 },
                  { "type": "field", "label": "Conditions", "bind": "$.conditions", "widget": "textarea", "height": 5, "colspan": 1 },
                  { "type": "field", "label": "Size", "bind": "$.size", "widget": "entry", "colspan": 1 }
                ]
              }
            ]
          },
          {
            "id": "tab_combat_skills",
            "title": "Combat & Skills",
            "sections": [
              {
                "id": "armor_block",
                "title": "Armor",
                "layout": { "type": "grid", "columns": 3 },
                "widgets": [
                  {
                    "type": "table_inline",
                    "id": "armor_slots",
                    "bind": "$.armor.slots",
                    "mode": "keyed_object",
                    "rows": [
                      { "key": "head_0", "label": "Head (0)" },
                      { "key": "body_1_5", "label": "Body (1-5)" },
                      { "key": "right_leg_6", "label": "Right Leg (6)" },
                      { "key": "left_leg_7", "label": "Left Leg (7)" },
                      { "key": "right_arm_8", "label": "Right Arm (8)" },
                      { "key": "left_arm_9", "label": "Left Arm (9)" }
                    ],
                    "columns": [
                      { "key": "AR", "label": "AR", "width": 6 },
                      { "key": "ENC", "label": "ENC", "width": 6 },
                      { "key": "Type", "label": "Type", "width": 16 }
                    ]
                  },
                  {
                    "type": "group",
                    "id": "shield",
                    "title": "Shield (BR/Type/ENC)",
                    "layout": { "type": "grid", "columns": 3 },
                    "widgets": [
                      { "type": "field", "label": "BR", "bind": "$.armor.shield.BR", "widget": "spin_int", "min": 0, "max": 99 },
                      { "type": "field", "label": "Type", "bind": "$.armor.shield.Type", "widget": "entry" },
                      { "type": "field", "label": "ENC", "bind": "$.armor.shield.ENC", "widget": "spin_int", "min": 0, "max": 99 }
                    ]
                  },
                  { "type": "field", "label": "Armor Notes", "bind": "$.armor.notes", "widget": "textarea", "height": 4, "colspan": 3 }
                ]
              },
              {
                "id": "skills_block",
                "title": "Skills",
                "layout": { "type": "grid", "columns": 1 },
                "widgets": [
                  {
                    "type": "table",
                    "id": "skills_table",
                    "bind": "$.skills",
                    "style": "skill",
                    "columns": [
                      { "key": "name", "label": "Skill", "width": 34 },
                      { "key": "rank", "label": "Rank", "width": 12 },
                      { "key": "bonus", "label": "Bonus", "width": 8 },
                      { "key": "tn", "label": "TN", "width": 8 }
                    ],
                    "row_editor": {
                      "fields": [
                        { "label": "Skill", "key": "name", "widget": "entry" },
                        { "label": "Rank", "key": "rank", "widget": "entry" },
                        { "label": "Bonus", "key": "bonus", "widget": "spin_int", "min": -99, "max": 999 },
                        { "label": "TN", "key": "tn", "widget": "spin_int", "min": 0, "max": 999 },
                        { "label": "Governing", "key": "governing", "widget": "tags", "hint": "e.g. Agility, Perception" }
                      ],
                      "buttons": ["add", "update", "delete"]
                    }
                  },
                  {
                    "type": "field",
                    "label": "Professions / Custom Skills",
                    "bind": "$.professions_custom_skills",
                    "widget": "textarea",
                    "height": 3
                  },
                  {
                    "type": "group",
                    "id": "combat_style_block",
                    "title": "Combat Style (Str, Ag)",
                    "layout": { "type": "grid", "columns": 2 },
                    "widgets": [
                      { "type": "field", "label": "Name", "bind": "$.combat_style.name", "widget": "entry", "colspan": 2 }
                    ]
                  },
                  {
                    "type": "field",
                    "label": "Specializations",
                    "bind": "$.specializations",
                    "widget": "textarea",
                    "height": 3
                  }
                ]
              },
              {
                "id": "weapons_block",
                "title": "Weapons",
                "layout": { "type": "grid", "columns": 2 },
                "widgets": [
                  {
                    "type": "table",
                    "id": "melee_weapons",
                    "title": "Melee Weapons",
                    "bind": "$.melee_weapons",
                    "columns": [
                      { "key": "name", "label": "Name", "width": 22 },
                      { "key": "dmg", "label": "Dmg", "width": 8 },
                      { "key": "h", "label": "H", "width": 4 },
                      { "key": "reach", "label": "Reach", "width": 8 },
                      { "key": "enc", "label": "ENC", "width": 6 }
                    ],
                    "row_editor": { "buttons": ["add", "update", "delete"] }
                  },
                  {
                    "type": "table",
                    "id": "ranged_weapons",
                    "title": "Ranged Weapons",
                    "bind": "$.ranged_weapons",
                    "columns": [
                      { "key": "name", "label": "Name", "width": 22 },
                      { "key": "dmg", "label": "Dmg", "width": 8 },
                      { "key": "h", "label": "H", "width": 4 },
                      { "key": "reach", "label": "Reach", "width": 8 },
                      { "key": "enc", "label": "ENC", "width": 6 }
                    ],
                    "row_editor": { "buttons": ["add", "update", "delete"] }
                  }
                ]
              }
            ]
          },
          {
            "id": "tab_gear",
            "title": "Gear",
            "sections": [
              {
                "id": "talents_traits_powers",
                "title": "Talents, Traits, & Powers (Effects/Notes)",
                "layout": { "type": "grid", "columns": 1 },
                "widgets": [
                  { "type": "field", "label": "Notes", "bind": "$.talents_traits_powers", "widget": "textarea", "height": 7 }
                ]
              },
              {
                "id": "items_equipment",
                "title": "Items & Equipment",
                "layout": { "type": "grid", "columns": 2 },
                "widgets": [
                  {
                    "type": "table",
                    "id": "items_table",
                    "bind": "$.items_equipment",
                    "columns": [
                      { "key": "item", "label": "Item", "width": 36 },
                      { "key": "enc", "label": "ENC", "width": 6 }
                    ],
                    "row_editor": { "buttons": ["add", "update", "delete"] }
                  },
                  {
                    "type": "group",
                    "id": "enc_money",
                    "title": "Totals",
                    "layout": { "type": "grid", "columns": 2 },
                    "widgets": [
                      { "type": "field", "label": "Total ENC", "bind": "$.total_enc", "widget": "spin_int", "min": 0, "max": 999 },
                      { "type": "field", "label": "Drakes", "bind": "$.drakes", "widget": "spin_int", "min": 0, "max": 999999 }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "id": "tab_magic",
            "title": "Magic",
            "sections": [
              {
                "id": "rituals",
                "title": "Rituals",
                "layout": { "type": "grid", "columns": 1 },
                "widgets": [
                  { "type": "field", "label": "Rituals", "bind": "$.rituals", "widget": "textarea", "height": 4 }
                ]
              },
              {
                "id": "magic_skills",
                "title": "Skills (Magic)",
                "layout": { "type": "grid", "columns": 1 },
                "widgets": [
                  {
                    "type": "table",
                    "id": "magic_skills_table",
                    "bind": "$.magic_skills",
                    "style": "skill",
                    "columns": [
                      { "key": "name", "label": "Skill", "width": 22 },
                      { "key": "rank", "label": "Rank", "width": 12 },
                      { "key": "bonus", "label": "Bonus", "width": 8 },
                      { "key": "tn", "label": "TN", "width": 8 }
                    ],
                    "defaults": [
                      { "name": "Alteration (Wp)", "rank": "", "bonus": 0, "tn": 0 },
                      { "name": "Conjuration (Wp)", "rank": "", "bonus": 0, "tn": 0 },
                      { "name": "Destruction (Wp)", "rank": "", "bonus": 0, "tn": 0 },
                      { "name": "Illusion (Wp)", "rank": "", "bonus": 0, "tn": 0 },
                      { "name": "Mysticism (Wp)", "rank": "", "bonus": 0, "tn": 0 },
                      { "name": "Necromancy (Int)", "rank": "", "bonus": 0, "tn": 0 },
                      { "name": "Restoration (Wp)", "rank": "", "bonus": 0, "tn": 0 }
                    ]
                  },
                  { "type": "field", "label": "Spellcasting", "bind": "$.spellcasting", "widget": "textarea", "height": 3 }
                ]
              },
              {
                "id": "spells",
                "title": "Spells",
                "layout": { "type": "grid", "columns": 1 },
                "widgets": [
                  {
                    "type": "table",
                    "id": "spells_table",
                    "bind": "$.spells",
                    "columns": [
                      { "key": "level", "label": "Level", "width": 6 },
                      { "key": "cost", "label": "Cost", "width": 6 },
                      { "key": "spell_str", "label": "Spell Str.", "width": 10 },
                      { "key": "name_attr", "label": "Name: Attr.", "width": 24 },
                      { "key": "description", "label": "Description", "width": 40 }
                    ],
                    "row_editor": { "buttons": ["add", "update", "delete"] }
                  },
                  { "type": "field", "label": "Specializations", "bind": "$.specializations", "widget": "textarea", "height": 3 }
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "id": "import_window",
      "type": "dialog",
      "title": "Import Base Data",
      "layout": { "type": "grid", "columns": 2 },
      "widgets": [
        { "type": "button", "text": "Choose JSON…", "command": "import_choose_json", "colspan": 2 },
        { "type": "field", "label": "Selected file", "bind": "$dialog.selected_path", "widget": "readonly_entry", "colspan": 2 },
        { "type": "preview", "id": "import_preview", "bind": "$dialog.preview", "height": 10, "colspan": 2 },
        { "type": "field", "label": "Overwrite existing fields", "bind": "$dialog.overwrite", "widget": "check", "colspan": 2 },
        { "type": "button", "text": "Import", "command": "import_apply", "colspan": 1 },
        { "type": "button", "text": "Cancel", "command": "dialog_close", "colspan": 1 }
      ],
      "import_map": {
        "name": "$.name",
        "race": "$.race",
        "concept": "$.concept",
        "favored_characteristics": "$.favored_characteristics",
        "birthsign": "$.birthsign",
        "characteristics": "$.characteristics",
        "derived_stats": "$.derived_stats",
        "luck_numbers": "$.luck_numbers",
        "skills": "$.skills"
      }
    }
  ]
}
